### VARIABLES GLOBALES
@baseUrl = http://localhost:3000/api/v1
@json = application/json

### ==========================
### USUARIOS
### ==========================

### Lista usuarios
GET {{baseUrl}}/usuarios

### Lista usuarios limite
GET {{baseUrl}}/usuarios?page=1&limit=5

### Obtener usuario por id
GET {{baseUrl}}/usuarios/24

### Obtener usuarios con password vencida (mas de 90 dias)
GET {{baseUrl}}/usuarios/password-vencidas

### Crear usuario
POST {{baseUrl}}/usuarios
Content-Type: {{json}}

{
  "email": "test.ultimotest2@example.com",
  "password": "123ultimotest2",
  "usuario": "UltimoUser2",
  "nyap": "Usuario Test Final2",
  "fecha_nac": "1999-12-30",
  "sexo":"M",
  "cp":"5000",
  "id_pais":"10",
  "id_tipo_usuario": "2"
}

### Test crear usuario (ERROR: FALTA EMAIL)
POST {{baseUrl}}/usuarios
Content-Type: {{json}}

{
  "password": "Secr3t0!",
  "fecha_nac": "1999-11-14"
  
}

### Test crear usuario (ERROR: EMAIL REPETIDO)
POST {{baseUrl}}/usuarios
Content-Type: {{json}}

{
  "email": "test.softdelete@actualizado",
  "password": "Secr3t0!"
  
}

### Actualizar a un usuario
PUT {{baseUrl}}/usuarios/26
Content-Type: {{json}}

{
  "password": "new hasshed password",
  "id_tipo_usuario": 3,
  "fecha_nac": "2000-12-23",
  "sexo": "O"
}

### Soft delete de usuario (Cambia estado activo de 1 a 0)
DELETE {{baseUrl}}/usuarios/26

### Hard delete (eliminación permanente) /No recomendado ya que deja huecos en la bb.dd ;(
DELETE {{baseUrl}}/usuarios/25?force=true

### Reactivar usuario
PUT {{baseUrl}}/usuarios/26
Content-Type: {{json}}

{
  "activo": true
}

### ==========================
### ARTISTAS
### ==========================

### Lista Artista
GET {{baseUrl}}/artistas

### Obtener artista por id
GET {{baseUrl}}/artistas/51

### Crear artista
POST {{baseUrl}}/artistas
Content-Type: {{json}}

{
  "artista": "Bullet For My Valentine"
}

### ==========================
### PAISES
### ==========================

### Listar todos los países
GET {{baseUrl}}/paises?page=1&limit=20

### Listar solo 5 países
GET {{baseUrl}}/paises?limit=5

### Obtener país por ID
GET {{baseUrl}}/paises/1

### Crear nuevo país (ÉXITO)
POST {{baseUrl}}/paises
Content-Type: application/json

{
  "pais": "Reino Unido"
}

### Crear país (ERROR - duplicado)
POST {{baseUrl}}/paises
Content-Type: application/json

{
  "pais": "Argentina"
}

### Crear país (ERROR - falta datos)
POST {{baseUrl}}/paises
Content-Type: application/json

{
  "pais": ""
}

### ==========================
### DISCOGRAFICAS
### ==========================

### Listar todas las discográficas
GET {{baseUrl}}/discograficas?page=1&limit=20

### Obtener discográfica por ID
GET {{baseUrl}}/discograficas/58

### Filtrar discográficas por país
GET {{baseUrl}}/discograficas/pais/10

### Crear nueva discográfica 
POST {{baseUrl}}/discograficas
Content-Type: application/json

{
  "discografica": "Visible Noise",
  "id_pais": 15
}

### Crear discográfica (ERROR - duplicada)
POST {{baseUrl}}/discograficas
Content-Type: application/json

{
  "discografica": "Visible Noise", 
  "id_pais": 15
}

### Crear discográfica (ERROR - falta datos)
POST {{baseUrl}}/discograficas
Content-Type: application/json

{
  "discografica": "Visible Noise"
}

### ==========================
### ALBUMES
### ==========================

### Lista albumes completa
GET {{baseUrl}}/albumes

### Lista albumes por artista
GET {{baseUrl}}/albumes?artistaId=51

### Lista de canciones en un album
GET {{baseUrl}}/albumes/54/canciones

### Crear album
POST {{baseUrl}}/albumes
Content-Type: {{json}}

{
  "album": "The Poison",
  "id_artista": 53,
  "id_discografica": 58,
  "anio_publicacion": 2005
}

### ==========================
### CANCIONES
### ==========================

### Lista canciones
GET {{baseUrl}}/canciones

### Lista canciones por genero
GET {{baseUrl}}/canciones?genero=1

### Lista canciones por artista
GET {{baseUrl}}/canciones?artistaId=1

### Lista canciones por album
GET {{baseUrl}}/canciones?albumId=54

### Buscar cancion por id
GET {{baseUrl}}/canciones/144

### Crear canción
POST {{baseUrl}}/canciones
Content-Type: application/json

{
  "cancion": "Tears Don't Fall" ,
  "duracion_seg": 348,
  "id_album": 56,
  "reproducciones": 12395532,
  "likes": 67000
}

### Crear canción (ERROR - falta nombre)
POST {{baseUrl}}/canciones
Content-Type: application/json

{
  "duracion_seg": 200,
  "id_album": 1
}

### Crear canción ERROR - duración invalida
POST {{baseUrl}}/canciones
Content-Type: application/json

{
  "cancion": "Test cancion",
  "duracion_seg": 0,
  "id_album": 1
}

### Crear canción ERROR - album no existe
POST {{baseUrl}}/canciones
Content-Type: application/json

{
  "cancion": "Test cancion",
  "duracion_seg": 180,
  "id_album": 9999
}


### Asociar genero a cancion
POST {{baseUrl}}/canciones/144/generos/
Content-Type: {{json}}

{
  "id_genero": 14
}

### Quitar genero a cancion
DELETE {{baseUrl}}/canciones/142/generos/1

### ==========================
### GENEROS
### ==========================

### Lista de generos
GET {{baseUrl}}/generos

### Añadir genero
POST {{baseUrl}}/generos
Content-Type: {{json}}

{
  "genero": "Metalcore"
}

### ==========================
### PLAYLISTS
### ==========================

### Lista de playlists
GET {{baseUrl}}/playlists

### Lista de palylist por id
GET {{baseUrl}}/playlists/13

### Crear playlist
POST {{baseUrl}}/playlists
Content-Type: {{json}} 

{
  "playlist": "Bullet",
  "id_usuario": 24
}

### Soft Delete / Recuperar playlist
PUT {{baseUrl}}/playlists/12
Content-Type: {{json}}

{
  "estado": "eliminada"
}

### Actualizar playlist
Put {{baseUrl}}/playlists/12
Content-Type: {{json}}

{
 "playlist": "Test soft delete" 
}

### Agregar cancion a una playlist
POST {{baseUrl}}/playlists/13/canciones
Content-Type: {{json}}

{
  "id_cancion": 144,
  "orden": 1
}

### ERROR agregar cancion a una playlist eliminada
POST {{baseUrl}}/playlists/12/canciones
Content-Type: {{json}}

{
  "id_cancion": 142,
  "orden": 1
}

### Quitar canción de playlist
DELETE {{baseUrl}}/playlists/12/canciones/142

### ==========================
### SUSCRIPCIONES
### ==========================

### Lista de suscripciones
GET {{baseUrl}}/suscripciones

### Suscripciones por id
GET {{baseUrl}}/suscripciones/98

### Crear suscripciones error fecha
POST {{baseUrl}}/suscripciones
Content-Type: {{json}}

{
  "id_usuario": 24,
  "id_tipo_usuario": 1,
  "fecha_inicio": "2025-10-01T00:00:00Z",
  "fecha_renovacion": "2024-11-01T00:00:00Z"
}

### Crear suscripcion / Comprobacion fecha de inicio repetida
POST {{baseUrl}}/suscripciones
Content-Type: {{json}}

{
  "id_usuario": 24,
  "id_tipo_usuario": 1,
  "fecha_inicio": "2024-11-14T00:00:00Z",
  "fecha_renovacion": "2025-11-14T00:00:00Z"
}

### Actualizar suscripcion cambiar fecha renovacion
PUT {{baseUrl}}/suscripciones/98
Content-Type: application/json

{
  "fecha_renovacion": "2025-12-31"
}

### Actualizar suscripcion cambiar tipo de usuario
PUT {{baseUrl}}/suscripciones/98
Content-Type: application/json

{
  "id_tipo_usuario": 2
}

### Actualizar suscripcion ERROR fecha inválida
PUT {{baseUrl}}/suscripciones/98
Content-Type: application/json

{
  "fecha_renovacion": "fecha-invalida"
}

### Actualizar suscripcion ERROR fecha anterior a inicio
PUT {{baseUrl}}/suscripciones/98
Content-Type: application/json

{
  "fecha_renovacion": "2019-01-01"
}

### Actualizar suscripcion ERROR tipo usuario no existe
PUT {{baseUrl}}/suscripciones/1
Content-Type: application/json

{
  "id_tipo_usuario": 999
}

### Actualizar suscripcion ERROR suscripcion no existe
PUT {{baseUrl}}/suscripciones/999
Content-Type: application/json

{
  "fecha_renovacion": "2025-12-31"
}

### ==========================
### METODOS DE PAGO
### ==========================

### ERROR lista de pagos requiere id del usuario
GET {{baseUrl}}/metodos-pago

### Lista de metodos de pago por usuario
GET {{baseUrl}}/metodos-pago?usuarioId=24

### Crear método de pago (sin CVC; tarjeta enmascarada por el servidor)
### Id forma de pago( 1 = Efectivo, 2 = Tarjeta de Debito, 3 = Tarjeta de credito, 4 = Debito Automatico x Banco.)
POST {{baseUrl}}/metodos-pago
Content-Type: {{json}}

{
  "id_usuario": 24,
  "tipo_forma_pago": "Tarjeta de crédito",
  "nro_tarjeta": "4519856744441234",
  "mes_caduca": 12,
  "anio_caduca": 2030,
  "banco_codigo": "BANKO"
}

### ==========================
### PAGOS
### ==========================

# Registrar pago (referenciando suscripción y método de pago válidos)
POST {{baseUrl}}/pagos
Content-Type: {{json}}

{
  "id_usuario": 24,
  "id_suscripcion": 98,
  "id_datos_pago": 45,
  "importe": 1000,
  "fechaPago": "2025-11-22T00:00:00Z"
}

### Listar pagos por usuario y rango
GET {{baseUrl}}/pagos?usuarioId=1&desde=2020-01-01&hasta=2021-02-01

### Buscar pago por id del pago
GET {{baseUrl}}/pagos/1

### ==========================
### VISTAS AVANZADAS CON JOINS (EJERCICIOS ADICIONALES)
### ==========================

### EJERCICIO 1: Canciones populares por país
# Obtener las canciones más reproducidas agrupadas por país de usuarios
# Incluye: nombre_cancion, nombre_artista, nombre_album, nombre_pais, total_reproducciones, apariciones_en_playlists
GET {{baseUrl}}/vistas/canciones-populares-por-pais

### EJERCICIO 1: Con filtros opcionales (por país específico)
GET {{baseUrl}}/vistas/canciones-populares-por-pais?pais=Argentina

### EJERCICIO 1: Con límite de resultados
GET {{baseUrl}}/vistas/canciones-populares-por-pais?limit=3

### EJERCICIO 2: Ingresos por artista y discográfica (NO FUNCIONA)
# Analizar ingresos generados por cada combinación artista-discográfica
# Incluye: nombre_artista, nombre_discografica, nombre_pais_discografica, total_ingresos, cantidad_suscripciones_activas, total_canciones, promedio_reproducciones
GET {{baseUrl}}/vistas/ingresos-por-artista-discografica

### EJERCICIO 2: Con filtro por país de discográfica
GET {{baseUrl}}/vistas/ingresos-por-artista-discografica?pais=Argentina

### EJERCICIO 2: Con filtro por monto mínimo de ingresos
GET {{baseUrl}}/vistas/ingresos-por-artista-discografica?minimo_ingresos=50

### EJERCICIO 2: Con ordenamiento por cantidad de suscripciones
GET {{baseUrl}}/vistas/ingresos-por-artista-discografica?orden=suscripciones